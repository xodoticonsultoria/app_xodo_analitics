{% extends "base.html" %}
{% block content %}

<h2>Produção (para amanhã)</h2>

<form method="POST" action="/salvar" onsubmit="return bloquearBotao(this)">
<input type="hidden" name="tipo" value="producao">

{% for produto in produtos %}
<div class="produto">
    <span>{{ produto[1] }}</span>

    <div class="contador">
        <button type="button" onclick="diminuir({{ produto[0] }})">-</button>

        <input type="number"
               id="produto_{{ produto[0] }}"
               name="produto_{{ produto[0] }}"
               value="0" min="0" readonly>

        <button type="button" onclick="aumentar({{ produto[0] }})">+</button>
    </div>
</div>
{% endfor %}

<button type="submit" class="salvar" id="btnSalvar">
Salvar Produção
</button>

</form>

<script>
function vibrar() {
    if (navigator.vibrate) {
        navigator.vibrate(30);
    }
}

function aumentar(id){
  let el = document.getElementById("produto_"+id);
  el.value = parseInt(el.value) + 1;
  vibrar();
}

function diminuir(id){
  let el = document.getElementById("produto_"+id);
  if(parseInt(el.value) > 0){
    el.value = parseInt(el.value) - 1;
    vibrar();
  }
}

function bloquearBotao(form){
    let btn = document.getElementById("btnSalvar");
    btn.innerText = "Salvando...";
    btn.disabled = true;
    return true;
}
</script>

{% endblock %}